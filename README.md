# Machine Learning Model specification in JSON 
## For deployment in Inference/Scoring Engines

JSON is a simple data interchange format which has gained tremendous popularity. The aim of this specification is to present a way in which people can export their Machine Learning models into JSON and then import this JSON model and run inference/scoring on new data in any platform of choice. 

For example, a model developed using Python `scikit-learn` can be exported into the JSON model, which can then be imported by a Dart scoring engine to run inference on a Flutter mobile application.

## Specification

A model specification `json` file includes the following top-level keys:

| # | Name | Value Type | Optional | Description |
|-----|-----|------|------|--------|
|1| `"input"` | `object` | No | Provides the names and types of model input fields. Each field represents an independent variable of the model (`X`) | 
|2| `"output"` | `object` | No | Provides the name and type of model onput field. It represents the target variable of the model (`Y`). | 
|3| `"transformer"` | `object` | Yes | Provides the details in regards to the data transformation the input goes through before entering the model. |
|4| `"model"` | `object` | No | Provides the details of the Machine Learning model. |

Let us take a deep dive into each of the above objects:

### 1. `input`

The `object` corresponding to `"input"` is a map of field names (keys) and details corresponding to those fields (values). 

For example, if there is a field (independent variable) having name - "Dependents" which represents the number of family members (integer value) who depend on the given person, then it will be represented as  `"Dependents": {"type": "int"}` in the field map. In case there is a categorical variable like `Gender` which can have any one of the fixed categorical values (`Male` and `Female`) as input, the field will be represented as  `"Gender": {"type": "category", "values": ["Female", "Male" ]}`. The reason for including values is to perform One-Hot Encode operation where the input values are replaced by their index locations in the array corresponding to `"values"`.

Currently, this specification allows 4 types of fields - "bool", "int", "float" and "category". A representative example is shown below for better understanding.

**Example**
```json
"input": {
        "Gender": {
            "type": "category",
            "values": [
                "Female",
                "Male"
            ]
        },
        "IsMarried": {
            "type": "bool"
        },
        "Dependents": {
            "type": "int"
        },
        "Applicant Income": {
            "type": "float"
        },
        "Loan Amount": {
            "type": "int"
        },
        "Property Area": {
            "type": "category",
            "values": [
                "Rural",
                "Semiurban",
                "Urban"
            ]
        }
    },
```

### 2. `output`

The `object` corresponding to `"output"` is a singleton map containing the field name of the target variable (`Y`) and the type & value details corresponding to this field.

Some examples are provided below:

```json
"output": {
    "Predicted Price": {
        "type": "float"
    }
},
```

When a ML model outputs discrete indexes representing some meaningful output (in original data in case of supervised learning model), "category"` type output is used where the array corresponding to `"values"` represent the text at the location corresponding to the output index generated by the model.

```json
"output": {
    "species": {
        "type": "category",
        "values": [
            "versicolor",
            "setosa",
            "virginica"
        ]
    }
},
```

### 3. `transformer`

Transformers provide certain rules for transforming the input data before it enters the model. It can also include the parameters for transforming output field which is used to inverse transform the model output to fetch the real output of the model after scoring. The specification currently supports `Standard` and `MinMax` transformers which are two most popular ways of transforming the input data.

The transformer object is specified using a map with keys 

-  `"type"` - `"Standard"` or `"MinMax"` 
- `"scale_fields"` - a map of fields names (keys) and the corresponding map of scaling parameters (value) for the field. 

The scaling parameters a field include:
- `"mean"` and `"stddev"` if transformer type is `"Standard"`. For a field in the data with value `x` the transformed input is `x_new = (x - mean)/stddev`
- `"scale"` and `"min"` if transformer type is `"MinMax"`. For a field in the data with value `x` the transformed input is `x_new = x*scale + min`

#### 3.1 `Standard` Transformer Example 

```json
"transformer": {
    "type": "Standard",
    "scale_fields": {
        "X1": {
            "mean": 17.71256038647343,
            "stddev": 11.378717175302857
        },
        "X2": {
            "mean": 1083.8856889130436,
            "stddev": 1260.5843868803893
        },
        "X3": {
            "mean": 4.094202898550725,
            "stddev": 2.94200221305731
        },
        "X4": {
            "mean": 24.969030072463767,
            "stddev": 0.012395199368547943
        },
        "X5": {
            "mean": 121.53336108695655,
            "stddev": 0.015328636553097923
        },
        "Y": {
            "mean": 37.980193236714975,
            "stddev": 13.590044806293161
        }
    }
},
```

#### 3.2 `MinMax` Transformer Example 

```json
"transformer": {
    "type": "MinMax",
    "scale_fields": {
        "sepal length (cm)": {
            "scale": 0.27777777777777773,
            "min": -1.1944444444444442
        },
        "sepal width (cm)": {
            "scale": 0.41666666666666663,
            "min": -0.8333333333333333
        },
        "petal length (cm)": {
            "scale": 0.1694915254237288,
            "min": -0.1694915254237288
        },
        "petal width (cm)": {
            "scale": 0.4166666666666667,
            "min": -0.04166666666666667
        }
    }
},
```

### 4. `model`
